"use strict";(self.webpackChunkreact_monkey_blogging_boilerplate=self.webpackChunkreact_monkey_blogging_boilerplate||[]).push([[346],{3346:function(e,r,s){s.r(r);var n=s(1413),a=s(5861),t=s(9439),l=s(7757),c=s.n(l),i=s(2791),u=s(8322),o=s(3031),d=s(6356),m=s(3453),x=s(9248),h=s(4641),p=s(2582),f=s(8119),Z=s(460),j=s(3504),g=s(6871),v=s(1134),b=s(3585),N=s(9062),y=s(1199),k=s(4490),w=s(577),U=s(7531),I=s(9808),E=s(333),A=s.n(E),D=(s(289),s(184));r.default=function(){var e=(0,j.lr)(),r=(0,t.Z)(e,1)[0],s=(0,v.cI)({mode:"onChange",defaultValues:{}}),l=s.control,E=s.handleSubmit,S=s.watch,Q=s.reset,C=s.setValue,M=s.getValues,P=s.formState,V=P.isSubmitting,_=P.isValid,J=r.get("id"),B=S("status"),T=S("role"),O=M("avatar"),R=(0,g.s0)(),G=(0,k.Z)(C,M,(function(){return W.apply(this,arguments)})),L=G.handleSelectImage,q=G.setImage,F=(G.setProgress,G.handleDeleteImage),z=G.progress,H=G.image,K=G.imageName;function W(){return(W=(0,a.Z)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,N.JU)(y.db,"users",J),e.next=3,(0,N.r7)(r,{avatar:"",imageName:""});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if((0,i.useEffect)((function(){q(O)}),[O,q]),(0,i.useEffect)((function(){function e(){return(e=(0,a.Z)(c().mark((function e(){var r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,N.JU)(y.db,"users",J),e.next=3,(0,N.QT)(r);case 3:s=e.sent,Q(s.data());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[J,Q]),(0,I.a)().userInfo.role!==b.xZ.ADMIN)return(0,D.jsx)("div",{className:"text-[30px] font-semibold text-green-500 ",children:"This page is for admins only"});var X=function(){var e=(0,a.Z)(c().mark((function e(r){var s,a,t,l,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s=(0,N.JU)(y.db,"users",J),e.next=6,(0,N.r7)(s,(0,n.Z)((0,n.Z)({},r),{},{avatar:H,imageName:K,username:A()(r.username||r.fullname,{lower:!0})}));case 6:return a=(0,N.hJ)(y.db,"posts"),t=(0,N.IO)(a,(0,N.ar)("user.id","==",J)),e.next=10,(0,N.PL)(t);case 10:return l=e.sent,i=(0,N.qs)(y.db),l.forEach((function(e){var s=(0,N.JU)(y.db,"posts",e.id);i.update(s,{user:(0,n.Z)((0,n.Z)({},r),{},{id:J,avatar:H,imageName:K,username:A()(r.username||r.fullname,{lower:!0})})})})),e.next=15,i.commit();case 15:w.Am.success("Update User successfully!!"),R("/manage/user"),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),w.Am.error("Update User failed!!");case 22:case"end":return e.stop()}}),e,null,[[2,19]])})));return function(r){return e.apply(this,arguments)}}();return(0,D.jsxs)("div",{children:[(0,D.jsx)(u.Z,{title:"Update User",desc:"Update your User id : ".concat(J)}),(0,D.jsxs)("form",{onSubmit:E(X),children:[(0,D.jsx)("div",{className:"w-[200px] h-[200px] mx-auto mb-10 ",children:(0,D.jsx)(o.Z,{className:"!rounded-full h-full",onChange:L,handleDeleteImage:F,progress:z,image:H})}),(0,D.jsxs)("div",{className:"form-layout",children:[(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Fullname"}),(0,D.jsx)(x.Z,{name:"fullname",placeholder:"Enter your fullname",control:l})]}),(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Username"}),(0,D.jsx)(x.Z,{name:"username",placeholder:"Enter your username",control:l})]})]}),(0,D.jsxs)("div",{className:"form-layout",children:[(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Email"}),(0,D.jsx)(x.Z,{name:"email",placeholder:"Enter your email",control:l,type:"email"})]}),(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Password"}),(0,D.jsx)(h.Z,{control:l})]})]}),(0,D.jsxs)("div",{className:"form-layout",children:[(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Status"}),(0,D.jsxs)(p.Z,{children:[(0,D.jsx)(f.Z,{name:"status",control:l,checked:Number(B)===b.iQ.ACTIVE,value:b.iQ.ACTIVE,children:"Active"}),(0,D.jsx)(f.Z,{name:"status",control:l,checked:Number(B)===b.iQ.PENDING,value:b.iQ.PENDING,children:"Pending"}),(0,D.jsx)(f.Z,{name:"status",control:l,checked:Number(B)===b.iQ.BAN,value:b.iQ.BAN,children:"Banned"})]})]}),(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Role"}),(0,D.jsxs)(p.Z,{children:[(0,D.jsx)(f.Z,{name:"role",control:l,checked:Number(T)===b.xZ.ADMIN,value:b.xZ.ADMIN,children:"Admin"}),(0,D.jsx)(f.Z,{name:"role",control:l,checked:Number(T)===b.xZ.MOD,value:b.xZ.MOD,children:"Moderator"}),(0,D.jsx)(f.Z,{name:"role",control:l,checked:Number(T)===b.xZ.USER,value:b.xZ.USER,children:"User"})]})]}),(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(m.Z,{children:"Description"}),(0,D.jsx)(U.Z,{name:"description",control:l})]})]}),(0,D.jsxs)("div",{className:"gap-x-5 flex justify-center",children:[(0,D.jsx)("div",{children:(0,D.jsx)(Z.Z,{kind:"primary",className:"mx-auto w-[200px]",isLoading:V,disabled:V,type:"submit",children:"Update User"})}),(0,D.jsx)("div",{children:(0,D.jsx)(Z.Z,{to:"/manage/user",className:"mx-auto w-[100px] sm:w-[200px] md:w-[200px] lg:w-[200px]  ",kind:"ghost",type:"submit",children:"Back"})})]})]})]})}}}]);
//# sourceMappingURL=346.48653926.chunk.js.map