{"version":3,"file":"static/js/556.8d8fa259.chunk.js","mappings":"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","sources":["module/post/PostAddNewWithUser.js","../node_modules/quill-image-uploader/src/blots/image.js","../node_modules/quill-image-uploader/src/quill.imageUploader.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport Field from \"../../components/field/Field\";\r\nimport Label from \"../../components/label/Label\";\r\nimport Input from \"../../components/input/Input\";\r\nimport Dropdown from \"../../components/dropdown/Dropdown\";\r\nimport Button from \"../../components/button/Button\";\r\nimport Radio from \"../../components/checkbox/Radio\";\r\nimport Options from \"../../components/dropdown/Options\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport slugify from \"slugify\";\r\nimport { postStatus, userRole } from \"../../utils/constants\";\r\nimport ImageUpload from \"../../components/image/ImageUpload\";\r\nimport useFireBaseImage from \"../../hooks/useFireBaseImage\";\r\nimport Toggle from \"../../components/toggle/Toggle\";\r\nimport {\r\n  addDoc,\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  onSnapshot,\r\n  query,\r\n  serverTimestamp,\r\n  where,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"../../firebase-app/firebase-config\";\r\nimport Select from \"../../components/dropdown/Select\";\r\nimport List from \"../../components/dropdown/List\";\r\nimport { useAuth } from \"../../contexts/auth-context\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport ReactQuill, { Quill } from \"react-quill\";\r\nimport { useMemo } from \"react\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\n// import useFirebaseImage from \"../../hooks/useFireBaseImage\";\r\n\r\n// const storage = getStorage(); //lỗi thì để vào trong component\r\nimport ImageUploader from \"quill-image-uploader\";\r\nQuill.register(\"modules/imageUploader\", ImageUploader);\r\n\r\nconst PostAddNewStyles = styled.div``;\r\n\r\nconst PostAddNewWithUser = () => {\r\n  const { userInfo } = useAuth();\r\n  const [content, setContent] = useState(\"\");\r\n  const { control, watch, setValue, handleSubmit, getValues, reset } = useForm({\r\n    mode: \"onChange\",\r\n    defaultValues: {\r\n      title: \"\",\r\n      slug: \"\",\r\n      status: 2,\r\n      category: {},\r\n      hot: false,\r\n      user: {},\r\n      content: \"\",\r\n    },\r\n  });\r\n\r\n  const {\r\n    handleSelectImage,\r\n    setImage,\r\n    setProgress,\r\n    handleDeleteImage,\r\n    progress,\r\n    image,\r\n    imageName,\r\n  } = useFireBaseImage(setValue, getValues); //sử dụng custom hook\r\n\r\n  // console.log(\"PostAddNew ~ watchCategory\", watchCategory);\r\n\r\n  //set object user vào field: users để tối ưu hóa được bên component khác\r\n  useEffect(() => {\r\n    async function fetchUserData() {\r\n      if (!userInfo.email) return;\r\n      const q = query(\r\n        collection(db, \"users\"),\r\n        where(\"email\", \"==\", userInfo.email)\r\n      );\r\n      const querySnapShot = await getDocs(q);\r\n\r\n      querySnapShot.forEach((doc) => {\r\n        setValue(\"user\", {\r\n          id: doc.id,\r\n          ...doc.data(),\r\n        });\r\n      });\r\n    }\r\n    fetchUserData();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [userInfo.email]);\r\n\r\n  const [categories, setCategories] = useState([]);\r\n  const [titleCategory, setTitleCategory] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n  const modules = useMemo(\r\n    () => ({\r\n      toolbar: [\r\n        [\"bold\", \"italic\", \"underline\", \"strike\"],\r\n        [\"blockquote\"],\r\n        [{ header: 1 }, { header: 2 }], // custom button values\r\n        [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n        [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n        [\"link\", \"image\"],\r\n      ],\r\n      // imageUploader: {\r\n      //   upload: (file) => {\r\n      //     return new Promise((reslove, reject) => {\r\n      //       reslove(\r\n      //         \"https://images.unsplash.com/photo-1692610492938-37a4eed63ac0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=464&q=80\"\r\n      //       );\r\n      //     });\r\n      //   },\r\n      // },\r\n    }),\r\n    []\r\n  );\r\n\r\n  //query\r\n  useEffect(() => {\r\n    async function getData() {\r\n      const colRef = collection(db, \"categories\");\r\n      const q = query(colRef, where(\"status\", \"==\", 1));\r\n\r\n      const querySnapshot = await getDocs(q);\r\n      let results = [];\r\n      querySnapshot.forEach((doc) => {\r\n        results.push({ id: doc.id, ...doc.data() });\r\n      });\r\n      setCategories(results);\r\n    }\r\n    getData();\r\n  }, []);\r\n  //handle dropdown option đã tôi ưu hóa kiểu nhét cả 1 object category và field : categories\r\n  const handleClickOption = async (item) => {\r\n    // setValue(\"categoryId\", item.id);\r\n    const colRef = doc(db, \"categories\", item.id);\r\n    const docData = await getDoc(colRef);\r\n    setValue(\"category\", {\r\n      id: docData.id,\r\n      ...docData.data(),\r\n    });\r\n\r\n    setTitleCategory(item);\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.title = \"Monkey - Add new Posts\";\r\n  });\r\n\r\n  const addPostHandler = async (values) => {\r\n    setLoading(true);\r\n    try {\r\n      const cloneValues = { ...values };\r\n      cloneValues.slug = slugify(values.slug || values.title, { lower: true }); // người dùng nhập tiếng việt nó sẽ slug chính nó, lower : đưa về chữ thường hết\r\n      cloneValues.status = Number(values.status);\r\n      console.log(cloneValues);\r\n\r\n      // thêm posts\r\n      const colRef = collection(db, \"posts\");\r\n      await addDoc(colRef, {\r\n        ...cloneValues,\r\n        image,\r\n        imageName,\r\n        // categoryId: cloneValues.category.id,\r\n        // userId: cloneValues.user.id,\r\n        content: content,\r\n        createdAt: serverTimestamp(),\r\n      });\r\n      navigate(\"/my-post\");\r\n      toast.success(\"Create new Posts successfully!!\");\r\n      //reset\r\n      reset({\r\n        title: \"\",\r\n        slug: \"\",\r\n        status: 2,\r\n        category: {},\r\n        user: {},\r\n        hot: false,\r\n        image: \"\",\r\n        content: \"\",\r\n      });\r\n      setImage(\"\");\r\n      setProgress(0);\r\n      setTitleCategory({});\r\n      //---------\r\n    } catch (error) {\r\n      setLoading(false);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PostAddNewStyles>\r\n      <h1 className=\"dashboard-heading\">Add new post</h1>\r\n      <form action=\"\" onSubmit={handleSubmit(addPostHandler)}>\r\n        <div className=\"grid grid-cols-1 gap-x-10 mb-10 items-start md:grid-cols-2 md:gap-x-10 md:mb-10 md:items-start\">\r\n          <Field>\r\n            <Label>Title</Label>\r\n            <Input\r\n              control={control}\r\n              placeholder=\"Enter your title\"\r\n              name=\"title\"\r\n              required\r\n            ></Input>\r\n          </Field>\r\n          <Field>\r\n            <Label>Slug</Label>\r\n            <Input\r\n              control={control}\r\n              placeholder=\"Enter your slug\"\r\n              name=\"slug\"\r\n            ></Input>\r\n          </Field>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 gap-x-10 mb-10 items-start md:grid-cols-2 md:gap-x-10 md:mb-10 md:items-start\">\r\n          <Field>\r\n            <Label>Image</Label>\r\n            <ImageUpload\r\n              onChange={handleSelectImage}\r\n              className=\"h-[250px]\"\r\n              handleDeleteImage={handleDeleteImage}\r\n              progress={progress}\r\n              image={image}\r\n            ></ImageUpload>\r\n          </Field>\r\n          <Field>\r\n            <Label>Category</Label>\r\n            <Dropdown>\r\n              <Select\r\n                placeholder={titleCategory.name || \"Select the category\"}\r\n              ></Select>\r\n              <List>\r\n                {categories.length > 0 &&\r\n                  categories.map((item) => (\r\n                    <Options\r\n                      key={item.name}\r\n                      onClick={() => handleClickOption(item)}\r\n                    >\r\n                      {item.name}\r\n                    </Options>\r\n                  ))}\r\n              </List>\r\n            </Dropdown>\r\n          </Field>\r\n\r\n          {/* <Field>\r\n            <Label>Author</Label>\r\n            <Input control={control} placeholder=\"Find the author\"></Input>\r\n          </Field> */}\r\n        </div>\r\n        <div className=\"mb-10 entry-content\">\r\n          <Label>Content</Label>\r\n          <div className=\"mt-4\">\r\n            <ReactQuill\r\n              modules={modules}\r\n              theme=\"snow\"\r\n              value={content}\r\n              onChange={setContent}\r\n              className=\"w-full max-w-[350px] md:max-w-[760px] lg:max-w-full \"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex mr-14\">\r\n          <Button\r\n            type=\"submit\"\r\n            className=\"mx-auto w-[200px]\"\r\n            isLoading={loading}\r\n            disable={loading}\r\n          >\r\n            Add new post\r\n          </Button>\r\n        </div>\r\n      </form>\r\n    </PostAddNewStyles>\r\n  );\r\n};\r\n\r\nexport default PostAddNewWithUser;\r\n","import Quill from \"quill\";\r\n\r\nconst InlineBlot = Quill.import(\"blots/block\");\r\n\r\nclass LoadingImage extends InlineBlot {\r\n    static create(src) {\r\n        const node = super.create(src);\r\n        if (src === true) return node;\r\n\r\n        const image = document.createElement(\"img\");\r\n        image.setAttribute(\"src\", src);\r\n        node.appendChild(image);\r\n        return node;\r\n    }\r\n    deleteAt(index, length) {\r\n        super.deleteAt(index, length);\r\n        this.cache = {};\r\n    }\r\n    static value(domNode) {\r\n        const { src, custom } = domNode.dataset;\r\n        return { src, custom };\r\n    }\r\n}\r\n\r\nLoadingImage.blotName = \"imageBlot\";\r\nLoadingImage.className = \"image-uploading\";\r\nLoadingImage.tagName = \"span\";\r\nQuill.register({ \"formats/imageBlot\": LoadingImage });\r\n\r\nexport default LoadingImage;","import LoadingImage from \"./blots/image.js\";\r\n\r\nclass ImageUploader {\r\n    constructor(quill, options) {\r\n        this.quill = quill;\r\n        this.options = options;\r\n        this.range = null;             \r\n        this.placeholderDelta = null; \r\n\r\n        if (typeof this.options.upload !== \"function\")\r\n            console.warn(\r\n                \"[Missing config] upload function that returns a promise is required\"\r\n            );\r\n\r\n        var toolbar = this.quill.getModule(\"toolbar\");\r\n        if (toolbar) {\r\n            toolbar.addHandler(\"image\", this.selectLocalImage.bind(this));\r\n        }\r\n\r\n        this.handleDrop = this.handleDrop.bind(this);\r\n        this.handlePaste = this.handlePaste.bind(this);\r\n\r\n        this.quill.root.addEventListener(\"drop\", this.handleDrop, false);\r\n        this.quill.root.addEventListener(\"paste\", this.handlePaste, false);\r\n    }\r\n\r\n    selectLocalImage() {\r\n        this.quill.focus();\r\n        this.range = this.quill.getSelection();\r\n        this.fileHolder = document.createElement(\"input\");\r\n        this.fileHolder.setAttribute(\"type\", \"file\");\r\n        this.fileHolder.setAttribute(\"accept\", \"image/*\");\r\n        this.fileHolder.setAttribute(\"style\", \"visibility:hidden\");\r\n\r\n        this.fileHolder.onchange = this.fileChanged.bind(this);\r\n\r\n        document.body.appendChild(this.fileHolder);\r\n\r\n        this.fileHolder.click();\r\n\r\n        window.requestAnimationFrame(() => {\r\n            document.body.removeChild(this.fileHolder);\r\n        });\r\n    }\r\n\r\n    handleDrop(evt) {\r\n        if (\r\n            evt.dataTransfer &&\r\n            evt.dataTransfer.files &&\r\n            evt.dataTransfer.files.length\r\n        ) {\r\n            evt.stopPropagation();\r\n            evt.preventDefault();\r\n            if (document.caretRangeFromPoint) {\r\n                const selection = document.getSelection();\r\n                const range = document.caretRangeFromPoint(evt.clientX, evt.clientY);\r\n                if (selection && range) {\r\n                    selection.setBaseAndExtent(\r\n                        range.startContainer,\r\n                        range.startOffset,\r\n                        range.startContainer,\r\n                        range.startOffset\r\n                    );\r\n                }\r\n            } else {\r\n                const selection = document.getSelection();\r\n                const range = document.caretPositionFromPoint(evt.clientX, evt.clientY);\r\n                if (selection && range) {\r\n                    selection.setBaseAndExtent(\r\n                        range.offsetNode,\r\n                        range.offset,\r\n                        range.offsetNode,\r\n                        range.offset\r\n                    );\r\n                }\r\n            }\r\n\r\n            this.quill.focus();\r\n            this.range = this.quill.getSelection();\r\n            let file = evt.dataTransfer.files[0];\r\n\r\n            setTimeout(() => {\r\n                this.quill.focus();\r\n                this.range = this.quill.getSelection();\r\n                this.readAndUploadFile(file);\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    handlePaste(evt) {\r\n        let clipboard = evt.clipboardData || window.clipboardData;\r\n\r\n        // IE 11 is .files other browsers are .items\r\n        if (clipboard && (clipboard.items || clipboard.files)) {\r\n            let items = clipboard.items || clipboard.files;\r\n            const IMAGE_MIME_REGEX = /^image\\/(jpe?g|gif|png|svg|webp)$/i;\r\n\r\n            for (let i = 0; i < items.length; i++) {\r\n                if (IMAGE_MIME_REGEX.test(items[i].type)) {\r\n                    let file = items[i].getAsFile ? items[i].getAsFile() : items[i];\r\n\r\n                    if (file) {\r\n                        this.quill.focus();\r\n                        this.range = this.quill.getSelection();\r\n                        evt.preventDefault();\r\n                        setTimeout(() => {\r\n                            this.quill.focus();\r\n                            this.range = this.quill.getSelection();\r\n                            this.readAndUploadFile(file);\r\n                        }, 0);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    readAndUploadFile(file) {\r\n        let isUploadReject = false;\r\n\r\n        const fileReader = new FileReader();\r\n\r\n        fileReader.addEventListener(\r\n            \"load\",\r\n            () => {\r\n                if (!isUploadReject) {\r\n                    let base64ImageSrc = fileReader.result;\r\n                    this.insertBase64Image(base64ImageSrc);\r\n                }\r\n            },\r\n            false\r\n        );\r\n\r\n        if (file) {\r\n            fileReader.readAsDataURL(file);\r\n        }\r\n\r\n        this.options.upload(file).then(\r\n            (imageUrl) => {\r\n                this.insertToEditor(imageUrl);\r\n            },\r\n            (error) => {\r\n                isUploadReject = true;\r\n                this.removeBase64Image();\r\n                console.warn(error);\r\n            }\r\n        );\r\n    }\r\n\r\n    fileChanged() {\r\n        const file = this.fileHolder.files[0];\r\n        this.readAndUploadFile(file);\r\n    }\r\n\r\n    insertBase64Image(url) {\r\n        const range = this.range;\r\n                \r\n        this.placeholderDelta = this.quill.insertEmbed(\r\n            range.index,\r\n            LoadingImage.blotName,\r\n            `${url}`,\r\n            \"user\"\r\n        );\r\n    }\r\n\r\n    insertToEditor(url) {\r\n        const range = this.range;        \r\n\r\n        const lengthToDelete = this.calculatePlaceholderInsertLength();        \r\n        \r\n        // Delete the placeholder image\r\n        this.quill.deleteText(range.index, lengthToDelete, \"user\");\r\n        // Insert the server saved image\r\n        this.quill.insertEmbed(range.index, \"image\", `${url}`, \"user\");\r\n\r\n        range.index++;\r\n        this.quill.setSelection(range, \"user\");\r\n    }\r\n\r\n    // The length of the insert delta from insertBase64Image can vary depending on what part of the line the insert occurs\r\n    calculatePlaceholderInsertLength() {\r\n        return this.placeholderDelta.ops.reduce((accumulator, deltaOperation) => {            \r\n            if (deltaOperation.hasOwnProperty('insert'))\r\n                accumulator++;\r\n\r\n            return accumulator;\r\n        }, 0);\r\n    }\r\n\r\n    removeBase64Image() {        \r\n        const range = this.range;\r\n        const lengthToDelete = this.calculatePlaceholderInsertLength();\r\n\r\n        this.quill.deleteText(range.index, lengthToDelete, \"user\");\r\n    }\r\n}\r\n\r\nwindow.ImageUploader = ImageUploader;\r\nexport default ImageUploader;"],"names":["Quill","ImageUploader","PostAddNewStyles","styled","userInfo","useAuth","useState","content","setContent","useForm","mode","defaultValues","title","slug","status","category","hot","user","control","setValue","watch","handleSubmit","getValues","reset","useFireBaseImage","handleSelectImage","setImage","setProgress","handleDeleteImage","progress","image","imageName","useEffect","email","q","query","collection","db","where","getDocs","forEach","doc","id","data","fetchUserData","categories","setCategories","titleCategory","setTitleCategory","loading","setLoading","navigate","useNavigate","modules","useMemo","toolbar","header","list","colRef","querySnapshot","results","push","getData","handleClickOption","item","getDoc","docData","document","addPostHandler","values","cloneValues","slugify","lower","Number","console","log","addDoc","createdAt","serverTimestamp","toast","className","action","onSubmit","placeholder","name","required","onChange","length","map","onClick","theme","value","type","isLoading","disable","LoadingImage","index","this","cache","src","node","createElement","setAttribute","appendChild","domNode","dataset","custom","blotName","tagName","quill","options","range","placeholderDelta","upload","warn","getModule","addHandler","selectLocalImage","bind","handleDrop","handlePaste","root","addEventListener","focus","getSelection","fileHolder","onchange","fileChanged","body","click","window","requestAnimationFrame","removeChild","evt","dataTransfer","files","stopPropagation","preventDefault","caretRangeFromPoint","selection","clientX","clientY","setBaseAndExtent","startContainer","startOffset","caretPositionFromPoint","offsetNode","offset","file","setTimeout","readAndUploadFile","clipboard","clipboardData","items","IMAGE_MIME_REGEX","i","test","getAsFile","isUploadReject","fileReader","FileReader","base64ImageSrc","result","insertBase64Image","readAsDataURL","then","imageUrl","insertToEditor","error","removeBase64Image","url","insertEmbed","lengthToDelete","calculatePlaceholderInsertLength","deleteText","setSelection","ops","reduce","accumulator","deltaOperation","hasOwnProperty"],"sourceRoot":""}